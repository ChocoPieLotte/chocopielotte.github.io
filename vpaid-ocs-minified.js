isDebugLogging=!0,function(e){console.debug("=> preparing the Motionly VPAID object");var i={muted:!0},n={},t="AdError";function o(){void 0!==i.realTimeInterval&&(e.clearInterval(i.realTimeInterval),i.realTimeInterval=void 0),void 0!==i.progressInterval&&(e.clearInterval(i.progressInterval),i.progressInterval=void 0),void 0!==i.delegate&&(i.delegate.remove(),i.delegate=void 0),i.playing=!1}function d(e){console.debug("=> received from the player the invocation of the function '"+e+"'")}function a(e){return Math.round(e/1e3*100)/100}function r(e){var i=n[e];if(void 0!==i){for(var t=[],o=1;o<arguments.length;o++)t.push(arguments[o]);console.debug("=> sending to the player the event '"+e+"'");for(var d=0;d<i.length;d++){var a=i[d];a.callback.apply(a.context,t)}}}e.getVPAIDAd=function(){return console.debug("=> creating the Motionly VPAID object"),{handshakeVersion:function(e){return d("handshakeVersion"),console.debug("=> received a handshake with version '"+e+"'"),"2.0"},initAd:function(e,n,o,a,l,s){d("initAd"),console.debug("=> initializing the ad with dimensions ("+e+"x"+n+") with mode '"+o+"'"),i.containerDimensions={width:e,height:n},function e(n){try{d=JSON.parse(n.AdParameters)}catch(o){return console.error("=> could not parse the 'AdParameters' properly",o),r(t)}var d,a="sdkUrl",l="experiencePosterUrl",s="ratio",p="durationInMilliseconds",u="skipRangeInMilliseconds";return(i.sdkUrl=d[a],"string"!=typeof i.sdkUrl)?(console.error("=> the '"+a+"' parameter with value '"+i.sdkUrl+"' should be a URL"),r(t)):(i.experiencePosterUrl=d[l],"string"!=typeof i.experiencePosterUrl)?(console.error("=> the '"+l+"' parameter with value '"+i.experiencePosterUrl+"' should be a URL"),r(t)):(i.xpRatio=d[s],i.xpRatio<=0)?(console.error("=> the '"+s+"' parameter with value '"+i.xpRatio+"' should be greater than 0"),r(t)):(i.durationInMilliseconds=d[p],i.durationInMilliseconds<=0)?(console.error("=> the '"+p+"' parameter with value '"+i.durationInMilliseconds+"' should not be greater than 0"),r(t)):void(i.skippableRangeInMilliseconds=void 0!==d[u]?d[u]:[0,d.durationInMilliseconds],i.skippableRangeInMilliseconds[0]<0&&(console.warn("=> the '"+u+"' parameter with lower bound value '"+i.skippableRangeInMilliseconds[0]+"' should not be lower than 0"),i.skippableRangeInMilliseconds[0]=0),-1===i.skippableRangeInMilliseconds[1]?i.skippableRangeInMilliseconds[1]=i.durationInMilliseconds:i.skippableRangeInMilliseconds[1]>i.skippableRangeInMilliseconds?(console.warn("=> the '"+u+"' parameter with upper bound value "+i.skippableRangeInMilliseconds[1]+" should not be greater than the '"+p+"'"),i.skippableRangeInMilliseconds[1]=i.durationInMilliseconds):i.skippableRangeInMilliseconds[1]<=i.skippableRangeInMilliseconds[0]&&(console.warn("=> the '"+u+"' parameter with upper bound value "+i.skippableRangeInMilliseconds[1]+" should not be greater than its lower bound value "+i.skippableRangeInMilliseconds[0]),i.skippableRangeInMilliseconds[1]=i.durationInMilliseconds))}(l),i.adSkippableState=!1,i.videoSlot=s.videoSlot;var p,u,c,g,h,$,m,v,A,b,I=s.slot;i.window=I.ownerDocument.defaultView,i.slot=I,p=I,u=i.experiencePosterUrl,c=function(){console.log("-------------- AD LOADED"),i.videoSlot.src="https://raw.githubusercontent.com/ChocoPieLotte/vpaid-tests/main/bmw.mp4",i.videoSlot.play(),r("AdLoaded")},m=($=i.containerDimensions).width/$.height,v={},m>=i.xpRatio?(g="auto",h="100%",v.width=$.height/i.xpRatio,v.height=$.height):(g="100%",h="auto",v.width=$.width,v.height=$.width*i.xpRatio),console.log("11111 - xpDimensions",v),i.xpDimensions=v,A=document.createElement("img"),i.placeholder=A,(b=A.style).width=g,b.height=h,b.display="block",b.margin="auto",i.window.myCallbacks=function(){return{version:2,initialize:function(e,i,n){console.log("------------initialize",n)},overrideDescription:function(e,n){return i.description=n,n},onAction:function(e,i,n){r("AdClickThru",(void 0===n.urlMacro?"":n.urlMacro)+n.url,n.id,!1)},onTechnicalEvent:function(e,n,t){"installed"===t&&(console.log("CTA-white-ogury",n),n.nodeElement.style.position="absolute",n.nodeElement.style.top="0px",n.videoElement=i,c())}}},A.setAttribute("motionly-params",JSON.stringify({callbacks:"myCallbacks",setup:{runMode:"paused"},experienceId:"5741908500414464",dimensions:{buckets:[100,200,300,400,500,600,700,800,900,1e3]},metricsLevel:"none"})),A.onerror=function(){return console.error("=> could not load the experience poster"),r(t)},p.appendChild(A),void 0!==i.window.motionly&&i.window.motionly.AutoLoader.load(A),function e(n,t){if(void 0===i.window.motionly){var o=document.createElement("script");o.async=!0,o.onerror=function(){console.error("=> could not load the Motionly engine"),r("onError")},o.src=t,(void 0===n?document.head:n).appendChild(o)}}(I,i.sdkUrl)},startAd:function(){d("startAd");var n=Date.now(),a={startInMilliseconds:n,endInMilliseconds:n+i.durationInMilliseconds,durationInMilliseconds:i.durationInMilliseconds+0,elapsedInMilliseconds:0,remainingInMilliseconds:i.durationInMilliseconds,skippableRangeInMilliseconds:i.skippableRangeInMilliseconds,remainingEvents:["AdVideoStart","AdVideoFirstQuartile","AdVideoMidpoint","AdVideoThirdQuartile","AdVideoComplete"]};i.timing=a,console.info("=> the ad duration is of "+a.durationInMilliseconds+" ms");var l=1e3/60,s=function(e){var i=a.remainingEvents.indexOf(e);return -1!==i&&(a.remainingEvents.splice(i,1),r(e),!0)};i.realTimeInterval=e.setInterval(function(){!0===i.playing&&(a.elapsedInMilliseconds+=l,a.remainingInMilliseconds=a.durationInMilliseconds-a.elapsedInMilliseconds);var n=a.elapsedInMilliseconds/a.durationInMilliseconds;n>=1?s("AdVideoComplete"):n>=.75?s("AdVideoThirdQuartile"):n>=.5?s("AdVideoMidpoint"):n>=.25?s("AdVideoFirstQuartile"):!0===s("AdVideoStart")&&r("AdImpression");var t=a.elapsedInMilliseconds>=a.skippableRangeInMilliseconds[0]&&a.elapsedInMilliseconds<=a.skippableRangeInMilliseconds[1];t!==i.adSkippableState&&(i.adSkippableState=t,r("AdSkippableStateChange")),n>=1&&!0===i.playing&&(i.playing=!1,e.setTimeout(function(){o(),r("AdStopped")},5*l))},l);var p=i.window.motionly.Initializer.initializer.getHandlerByElement(i.placeholder);if(null===p){r(t);return}if(void 0!==p){i.delegate=p.delegate;try{i.delegate.play()}catch(u){console.error("=> could not play the Motionly experience",u),r(t);return}}i.playing=!0,r("AdStarted")},stopAd:function(){d("stopAd"),o(),r("AdStopped")},skipAd:function(){d("skipAd"),!1!==i.adSkippableState&&(o(),r("AdSkipped"),r("AdStopped"))},resizeAd:function(e,i,n){d("resizeAd"),console.debug("=> asking to resize the ad with dimensions ("+e+"x"+i+") with mode '"+n+"'"),r("AdSizeChange")},pauseAd:function(){d("pauseAd"),void 0!==i.delegate&&i.delegate.pause(),i.playing=!1,r("AdPaused")},resumeAd:function(){console.log("===============+resumeAd"),d("resumeAd"),void 0!==i.delegate&&i.delegate.play(),i.playing=!0,r("AdPlaying")},expandAd:function(){d("expandAd")},collapseAd:function(){d("collapseAd")},getAdIcons:function(){return d("getAdIcons"),""},getAdCompanions:function(){return d("getAdCompanions"),""},getAdRemainingTime:function(){return a(i.timing.remainingInMilliseconds)},getAdDuration:function(){return d("getAdDuration"),a(i.timing.durationInMilliseconds)},getAdWidth:function(){return d("getAdWidth"),i.xpDimensions.width},getAdHeight:function(){return d("getAdHeight"),i.xpDimensions.height},getAdLinear:function(){return d("getAdLinear"),!0},getAdSkippableState:function(){return d("getAdSkippableState"),i.adSkippableState},getAdExpanded:function(){return d("getAdExpanded"),!1},getAdVolume:function(){return d("getAdVolume"),!0===i.muted?0:1},setAdVolume:function(e){if(d("setAdVolume"),void 0!==i.delegate){i.muted=0===e;var n=i.delegate.getExperienceContext().properties.videos;if(void 0!==n)for(var t=0;t<n.length;t++)n[t].muted=i.muted}r("AdVolumeChange")},subscribe:function(e,i,t){var o=n[i];void 0===o&&(o=[],n[i]=o),o.push({reference:e,context:t,callback:e})},unsubscribe:function(e,i){var t="string"==typeof i?i:e;console.debug("=> unsubscribing from the event '"+t+"'"),delete n[t]}}}}(window);
